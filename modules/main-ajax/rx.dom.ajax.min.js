/* Copyright (c) Microsoft, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){function b(a){return a&&a.Object===Object?a:null}var c={"function":!0,object:!0},d=c[typeof exports]&&exports&&!exports.nodeType?exports:null,e=c[typeof module]&&module&&!module.nodeType?module:null,f=b(d&&e&&"object"==typeof global&&global),g=b(c[typeof self]&&self),h=b(c[typeof window]&&window),i=(e&&e.exports===d?d:null,b(c[typeof this]&&this)),j=f||h!==(i&&i.window)&&h||g||i||Function("return this")();"function"==typeof define&&define.amd?define(["rx"],function(b,c){return a(j,c,b)}):"object"==typeof module&&module&&module.exports===d?module.exports=a(j,module.exports,require("rx")):j.Rx=a(j,{},j.Rx)}).call(this,function(a,b,c,d){function e(){if(a.XMLHttpRequest)return new a.XMLHttpRequest;var b;try{for(var c=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],d=0;3>d;d++)try{if(b=c[d],new a.ActiveXObject(b))break}catch(e){}return new a.ActiveXObject(b)}catch(e){throw new Error("XMLHttpRequest is not supported by your browser")}}function f(){var b=new a.XMLHttpRequest;if("withCredentials"in b)return b;if(a.XDomainRequest)return new XDomainRequest;throw new Error("CORS is not supported by your browser")}function g(a,b,c){var d="response"in b?b.response:b.responseText;return d="json"===c.responseType?JSON.parse(d):d,{response:d,status:b.status,responseType:b.responseType,xhr:b,originalEvent:a}}function h(a,b,c){return{type:c,status:b.status,xhr:b,originalEvent:a}}var i=(c.Observable,c.ObservableBase),j=c.AnonymousObservable,k=c.DOM||(c.DOM={}),l={}.hasOwnProperty,m=c.internals.inherits,n=(function(a){function b(b){this._settings=b,a.call(this)}function c(a,b){this._xhr=a,this._parent=b,this.isDisposed=!1}return m(b,a),b.prototype.subscribeCore=function(a){this._isDone=!1},c.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._parent._isDone||4===this._xhr.readyState||this._xhr.abort())},b}(i),k.ajax=function(b){var c={method:"GET",crossDomain:!1,async:!0,headers:{},responseType:"text",createXHR:function(){return this.crossDomain?f():e()},normalizeError:h,normalizeSuccess:g};if("string"==typeof b)c.url=b;else for(var i in b)l.call(b,i)&&(c[i]=b[i]);var k=c.normalizeError,m=c.normalizeSuccess;return c.crossDomain||c.headers["X-Requested-With"]||(c.headers["X-Requested-With"]="XMLHttpRequest"),c.hasContent=c.body!==d,new j(function(b){var d,e=!1,f=function(a,d){var f=1223===a.status?204:a.status;f>=200&&300>=f||0===f||""===f?(b.onNext(m(d,a,c)),b.onCompleted()):b.onError(k(d,a,"error")),e=!0};try{d=c.createXHR()}catch(g){return b.onError(g)}try{c.user?d.open(c.method,c.url,c.async,c.user,c.password):d.open(c.method,c.url,c.async);var h=c.headers;for(var i in h)l.call(h,i)&&d.setRequestHeader(i,h[i]);d.upload||!("withCredentials"in d)&&a.XDomainRequest?(d.onload=function(a){c.progressObserver&&(c.progressObserver.onNext(a),c.progressObserver.onCompleted()),f(d,a)},c.progressObserver&&(d.onprogress=function(a){c.progressObserver.onNext(a)}),d.onerror=function(a){c.progressObserver&&c.progressObserver.onError(a),b.onError(k(a,d,"error")),e=!0},d.onabort=function(a){c.progressObserver&&c.progressObserver.onError(a),b.onError(k(a,d,"abort")),e=!0}):d.onreadystatechange=function(a){4===d.readyState&&f(d,a)},d.send(c.hasContent&&c.body||null)}catch(j){b.onError(j)}return function(){e||4===d.readyState||d.abort()}})});k.post=function(a,b){var c;return"string"==typeof a?c={url:a,body:b,method:"POST"}:"object"==typeof a&&(c=a,c.method="POST"),n(c)},k.get=function(a){var b;return"string"==typeof a?b={url:a}:"object"==typeof a&&(b=a),n(b)},k.getJSON=function(b){if(!a.JSON&&"function"!=typeof a.JSON.parse)throw new TypeError("JSON is not supported in your runtime.");return n({url:b,responseType:"json"}).map(function(a){return a.response})};var o=function(){var b="document"in a&&a.document.createElement("div");return function(a){b.appendChild(a),b.innerHTML=""}}();return k.jsonpRequest=function(){var b=0;return function(c){return new j(function(d){var e="callback_"+(b++).toString(36),f={jsonp:"JSONPCallback",async:!0,jsonpCallback:"rxjsjsonpCallbacks"+e};if("string"==typeof c)f.url=c;else for(var g in c)l.call(c,g)&&(f[g]=c[g]);var h=a.document.createElement("script");h.type="text/javascript",h.async=f.async,h.src=f.url.replace(f.jsonp,f.jsonpCallback),a[f.jsonpCallback]=function(b){a[f.jsonpCallback].called=!0,a[f.jsonpCallback].data=b};var i=function(b){"load"!==b.type||a[f.jsonpCallback].called||(b={type:"error"});var c="error"===b.type?400:200,e=a[f.jsonpCallback].data;200===c?(d.onNext({status:c,responseType:"jsonp",response:e,originalEvent:b}),d.onCompleted()):d.onError({type:"error",status:c,originalEvent:b})};h.onload=h.onreadystatechanged=h.onerror=i;var j=a.document.getElementsByTagName("head")[0]||a.document.documentElement;return j.insertBefore(h,j.firstChild),function(){h.onload=h.onreadystatechanged=h.onerror=null,o(h),h=null}})}}(),c});
//# sourceMappingURL=rx.dom.ajax.map